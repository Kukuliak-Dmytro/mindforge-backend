# Технічне завдання (ТЗ) на розробку платформи Mind Forge

---

## 1. Загальна інформація

**Назва проекту:** Mind Forge

**Мета:** Створення платформи для поєднання студентів з репетиторами з підтримкою реєстрації, профілів, замовлень, відгуків, чату.

**Архітектурна особливість:**
- Вся автентифікація та реєстрація користувачів реалізована на фронтенді через Supabase Auth.
- Бекенд працює лише з already-authenticated users, отримуючи JWT-токен від фронтенду.
- Всі таблиці захищені через Row Level Security (RLS) Supabase, доступ до даних можливий лише з валідним JWT або через офіційний клієнт Supabase з middleware.
- Бекенд не зберігає паролі, не керує сесіями, не реалізує логіку автентифікації.

**Стейкхолдери:**
- Студенти
- Репетитори
- Технічний лідер
- DevOps інженер
- QA команда
- Технічний письменник

---

## 2. Функціональні вимоги

### 2.1. Авторизація та доступ
- Вся автентифікація/реєстрація — на фронтенді через Supabase Auth.
- Бекенд приймає лише запити з валідним JWT (access token), перевіряє його через middleware.
- Всі таблиці захищені через RLS, бекенд не має доступу до даних без токена.

### 2.2. Профілі користувачів
- Єдиний профіль користувача (user).
- Дані про профіль репетитора підв'язані до userId (user → tutor).
- Редагування профілю (ім'я, фото, опис, контакти, предмети для репетиторів).
- Перегляд профілю іншого користувача.
- Відображення рейтингу та відгуків для репетиторів.
- [x] Профільна частина вже реалізована!

### 2.3. Система замовлень та сесій
- Створення замовлення студентом (вибір репетитора, предмет, дата/час, коментар).
- Прийняття/відхилення замовлення репетитором.
- Відображення історії замовлень для обох ролей.
- Стан замовлення: створено, підтверджено, завершено, скасовано.

### 2.4. Відгуки та рейтинги
- Студент може залишити відгук після завершення сесії.
- Рейтинг репетитора розраховується автоматично.
- Можливість перегляду всіх відгуків для репетитора.

### 2.5. Чат між користувачами
- Можливість ініціювати чат між студентом і репетитором (Supabase Realtime).
- Зберігання історії повідомлень.
- Push-нотифікації (опціонально).

---

## 3. Нефункціональні вимоги

- **Мова розробки:** TypeScript
- **Фреймворк:** Node.js + Express.js
- **ORM:** Prisma
- **База даних:** PostgreSQL (через Supabase)
- **Інтеграції:** Supabase (Auth, Realtime, RLS)
- **Контейнеризація:** Docker, Docker Compose
- **Тестування:** Jest (unit, integration, e2e)
- **Лінтінг/Форматування:** ESLint, Prettier
- **Документація:** JSDoc, Swagger/OpenAPI (відповідальність технічного письменника)
- **CI/CD:** Налаштування DevOps (відповідальність DevOps)
- **Безпека:** JWT, CORS, SSL (налаштування DevOps)

---

## 4. Архітектурні вимоги

- **Шарова архітектура:**
  - Сервісний шар (business logic, services/)
  - Контролерний шар (controllers/)
  - Репозиторії (repositories/)
  - Middleware (middlewares/)
  - Типи/інтерфейси (types/)
  - Утиліти (utils/)
  - Конфігурація (config/)
- **Використання патернів:** Dependency Injection, Separation of Concerns, DRY, KISS
- **Валідація:** Всі вхідні дані валідовані на рівні операцій
- **Обробка помилок:** Централізовано через middleware
- **Логування:** logger.ts

---

## 5. Деталізація модулів

### 5.1. Профілі (profile.controller.ts, profile.service.ts)
- GET /profile/me — отримати свій профіль
- PUT /profile/me — оновити профіль
- GET /profile/:id — переглянути профіль іншого користувача

### 5.2. Репетитори (tutor.controller.ts, tutor.service.ts)
- GET /tutors — список репетиторів (з фільтрами)
- GET /tutors/:id — деталі репетитора
- PUT /tutors/:id/subjects — оновити предмети

### 5.3. Замовлення (order.controller.ts, order.service.ts)
- POST /orders — створити замовлення
- GET /orders — список замовлень користувача
- GET /orders/:id — деталі замовлення
- PUT /orders/:id/status — змінити статус

### 5.4. Відгуки (review.controller.ts, review.service.ts)
- POST /reviews — створити відгук
- GET /reviews/tutor/:tutorId — всі відгуки для репетитора

### 5.5. Чат (chat.controller.ts, chat.service.ts)
- GET /chats — список чатів користувача
- GET /chats/:id — історія чату
- POST /chats/:id/messages — надіслати повідомлення

---

## 6. Вимоги до API

- RESTful підхід
- Всі відповіді у форматі JSON
- Валідація вхідних даних (validation.middleware.ts)
- Обробка помилок (error.middleware.ts)
- Авторизація через JWT (auth.middleware.ts) — тільки перевірка токена, не автентифікація!
-Використовувати базовий контролер класу
- Документація ендпоінтів (Swagger/OpenAPI — відповідальність технічного письменника)

---

## 7. Вимоги до бази даних

- **ORM:** Prisma
- **Схема:**
  - User (id, email, role, name, avatar, ...)
  - Tutor (id, userId, subjects, ...)
  - Order (id, studentId, tutorId, subject, status, ...)
  - Review (id, orderId, studentId, tutorId, rating, text, ...)
  - Chat (id, participants, ...)
  - Message (id, chatId, senderId, text, timestamp)
- **Міграції:** через prisma/migrations
- **Seed-дані:** scripts/seed.ts
- **RLS:** Всі таблиці захищені через Row Level Security Supabase

---

## 8. Вимоги до коду

- TypeScript, сувора типізація
- Дотримання архітектурних принципів (див. вище)
- Code style: ESLint, Prettier
- JSDoc для публічних методів
- Conventional Commits для git
- Всі бізнес-правила — у сервісах
- Вся валідація — в операціях
- Вся HTTP-логіка — у контролерах
- Не використовувати репозиторії напряму у контролерах
- Не писати тести, документацію API, README — це відповідальність інших ролей

---

## 9. Вимоги до тестування, деплою, CI/CD

- Unit, integration, e2e тести — відповідальність QA/DevOps
- CI/CD, інфраструктура, безпека — відповідальність DevOps
- Документація API, архітектурна, користувацька — відповідальність технічного письменника

---

## 10. Обмеження та виключення

- Розробник не пише тести, не налаштовує CI/CD, не пише документацію API, не оновлює README, не створює Swagger/OpenAPI, не пише інструкції для користувачів
- Всі ці аспекти виконуються відповідними командами після передачі коду

---

## 11. Додаткові вимоги

- Всі змінні середовища мають бути описані у .env.example
- Всі залежності мають бути задокументовані у package.json
- Всі скрипти для ініціалізації/seed мають бути у scripts/
- Dockerfile та docker-compose.yml мають забезпечувати повноцінний запуск проекту

---

## 12. Додатки

- [Документація Prisma](https://www.prisma.io/docs)
- [Документація Express](https://expressjs.com/)
- [Документація Supabase](https://supabase.com/docs)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)

---

**Кінець ТЗ** 